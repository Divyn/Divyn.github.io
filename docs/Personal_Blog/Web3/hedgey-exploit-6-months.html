<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Personal_Blog/Web3/hedgey-exploit-6-months" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Hedgey Finance Exploit: Six Months Later, Lessons Learned, and Code Revamped | Divyasshree’s Portfolio</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://divyn.github.io/img/portfolio-banner.jpg"><meta data-rh="true" name="twitter:image" content="https://divyn.github.io/img/portfolio-banner.jpg"><meta data-rh="true" property="og:url" content="https://divyn.github.io/docs/Personal_Blog/Web3/hedgey-exploit-6-months"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Hedgey Finance Exploit: Six Months Later, Lessons Learned, and Code Revamped | Divyasshree’s Portfolio"><meta data-rh="true" name="description" content="On April 19, 2024, Hedgey Finance faced an exploit resulting in the loss of approximately $2 million on the Ethereum network, along with numerous BONUS tokens on the Arbitrum network."><meta data-rh="true" property="og:description" content="On April 19, 2024, Hedgey Finance faced an exploit resulting in the loss of approximately $2 million on the Ethereum network, along with numerous BONUS tokens on the Arbitrum network."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://divyn.github.io/docs/Personal_Blog/Web3/hedgey-exploit-6-months"><link data-rh="true" rel="alternate" href="https://divyn.github.io/docs/Personal_Blog/Web3/hedgey-exploit-6-months" hreflang="en"><link data-rh="true" rel="alternate" href="https://divyn.github.io/docs/Personal_Blog/Web3/hedgey-exploit-6-months" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4ETH1W6VRP"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4ETH1W6VRP",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.98c96006.css">
<script src="/assets/js/runtime~main.051c8a99.js" defer="defer"></script>
<script src="/assets/js/main.41dbe4f8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Divyasshree Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Divyasshree Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Divyasshree’s Portfolio</b></a><a class="navbar__item navbar__link" href="/docs/intro">Home</a><a class="navbar__item navbar__link" href="/docs/category/featured-work">Work Samples</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/divyasshree-BQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://x.com/divyasshree_" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.youtube.com/@TechFictionist" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">My YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Divyasshree</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/featured-work">Featured Work</a><button aria-label="Expand sidebar category &#x27;Featured Work&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/personal-blog">Personal Blog</a><button aria-label="Collapse sidebar category &#x27;Personal Blog&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/game-theory">Game Theory</a><button aria-label="Expand sidebar category &#x27;Game Theory&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/kubernetes">Kubernetes</a><button aria-label="Expand sidebar category &#x27;Kubernetes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/web3">Web3</a><button aria-label="Collapse sidebar category &#x27;Web3&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Personal_Blog/Web3/the-end-of-eoas-how-rip-7212-changes-ethereum">The End of EOAs? How RIP-7212 Changes Everything</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Personal_Blog/Web3/hedgey-exploit-6-months">Hedgey Finance Exploit: Six Months Later, Lessons Learned, and Code Revamped</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Personal_Blog/Web3/blockchain-data-observability-opentelemetry">Blockchain Data Observability: When Your Data Pipeline Goes Offline</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/chaos-theory-quantum-computing-random-concepts">Chaos Theory, Quantum Computing, Random Concepts</a><button aria-label="Expand sidebar category &#x27;Chaos Theory, Quantum Computing, Random Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/think-tank">Think Tank</a><button aria-label="Expand sidebar category &#x27;Think Tank&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/personal-blog"><span itemprop="name">Personal Blog</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/web3"><span itemprop="name">Web3</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Hedgey Finance Exploit: Six Months Later, Lessons Learned, and Code Revamped</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Hedgey Finance Exploit: Six Months Later, Lessons Learned, and Code Revamped</h1></header>
<p>On April 19, 2024, <a href="https://medium.com/hedgey/hedgey-exploit-post-mortem-784e9860fd8d" target="_blank" rel="noopener noreferrer">Hedgey Finance faced an exploit</a> resulting in the loss of approximately $2 million on the Ethereum network, along with numerous BONUS tokens on the Arbitrum network.</p>
<p>This breach, due to a vulnerability in the <a href="https://vscode.blockscan.com/ethereum/0xBc452fdC8F851d7c5B72e1Fe74DFB63bb793D511" target="_blank" rel="noopener noreferrer">ClaimCampaigns.sol contract</a>, highlighted the critical role of smart contract security and the need for contract audits of high-value audits.</p>
<p>This article revisits the incident 6 months later, analyzes the attack flow, and examines Hedgey Finance’s response and the ongoing impact. We will also see the modifications made to the claim functionality.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-vulnerability-and-attack-flow">Key Vulnerability and Attack Flow<a href="#key-vulnerability-and-attack-flow" class="hash-link" aria-label="Direct link to Key Vulnerability and Attack Flow" title="Direct link to Key Vulnerability and Attack Flow">​</a></h2>
<p>Vulnerable Contract: ClaimCampaigns.sol</p>
<ul>
<li>Contract Address: <a href="https://explorer.bitquery.io/ethereum/smart_contract/0xBc452fdC8F851d7c5B72e1Fe74DFB63bb793D511" target="_blank" rel="noopener noreferrer">0xBc452fdC8F851d7c5B72e1Fe74DFB63bb793D511</a></li>
<li>Exploit Overview: The attacker exploited the createLockedCampaign() function, which lacked a mechanism to revoke token approvals after campaign cancellation. Consequently, the attacker could transfer funds by leveraging the transferFrom function, due to lingering token approvals.</li>
</ul>
<p>Detailed Attack Flow</p>
<ul>
<li>Initiation: The attacker initiated a flash loan of 1.305 million USDC from Balancer as shown in the transaction flow below.</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/hedgey-b1b7261aa7c1158dc610ea92e7dbce0d.png" width="1600" height="658" class="img_ev3q"></p>
<ul>
<li>Approval Exploit: The attacker called the createLockedCampaign() function, granting themselves an approval to transfer USDC tokens.</li>
</ul>
<p>We don’t see this function now in the ClaimCampaigns.sol file which is now replaced with <code>createUnlockedCampaign()</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/createUnlockedCampaign-da22851f518422c38f4c41bafea91273.png" width="1600" height="1142" class="img_ev3q"></p>
<ul>
<li>
<p>Cancellation with Exploit:</p>
</li>
<li>
<p>Within the same transaction, they called cancelCampaign(), withdrawing USDC without revoking the approval.</p>
</li>
<li>
<p>Execution of Transfer:</p>
</li>
<li>
<p>In a follow-up transaction, <a href="https://explorer.bitquery.io/ethereum/tx/0xa17fdb804728f226fcd10e78eae5247abd984e0f03301312315b89cae25aa517/tracing" target="_blank" rel="noopener noreferrer">they used transferFrom() to move 1,303,910 USDC out of the Hedgey Finance account.</a></p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/hedgey_follow_tx-50922cce1b65381ccafd4d79555753b3.png" width="1600" height="781" class="img_ev3q"></p>
<ul>
<li>Repeat Exploit: The attacker repeated the process with BONUS tokens on Arbitrum, resulting in an additional loss of approximately $600,000.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="visualizing-the-attack-flow">Visualizing the Attack Flow<a href="#visualizing-the-attack-flow" class="hash-link" aria-label="Direct link to Visualizing the Attack Flow" title="Direct link to Visualizing the Attack Flow">​</a></h4>
<p>Here’s a simplified flowchart detailing the exploitation process:</p>
<p><img decoding="async" loading="lazy" src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXf4fFKPzFknuWIEg_VylJEAzABq6VHm-y_I3toRhw3SQn6LdnEOqF0kkYJiJQhuB9NO05e1GkNFC00wDoBbSP0XCqUSLQTFbQwnLkqYGoez2WbcK3p9ZYdyQQNWcBB7icX_dGlVVQ?key=4txW0y9TvdjUk0Q0JjSepfYs" alt="" class="img_ev3q"></p>
<p>Each of these steps involved manipulating the createLockedCampaign() and cancelCampaign() functions to gain control over Hedgey Finance’s assets.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="impact-breakdown">Impact Breakdown<a href="#impact-breakdown" class="hash-link" aria-label="Direct link to Impact Breakdown" title="Direct link to Impact Breakdown">​</a></h2>
<ul>
<li>Total Loss: $2 million USD in various tokens, with the largest single extraction at 1.3 million USDC.</li>
<li>Additional Losses: Approximately $20,000 in MASA tokens and 78,148,820 BONUS tokens taken through similar exploits by copycat attackers.</li>
<li>Identified Attackers: At least three attackers were involved, with one primary address executing most of the losses on Ethereum.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="timeline-of-key-events">Timeline of Key Events<a href="#timeline-of-key-events" class="hash-link" aria-label="Direct link to Timeline of Key Events" title="Direct link to Timeline of Key Events">​</a></h2>
<ul>
<li>April 19, 2024: Initial exploit occurs; Hedgey loses $2 million.</li>
<li>April 20, 2024 - Present: Hedgey Finance collaborates with cybersecurity firms to investigate and recover funds.</li>
<li>Post-April 2024: Additional minor exploits by copycat attackers take a further $20,000 and 78 million BONUS tokens.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hedgey-finances-response">Hedgey Finance’s Response<a href="#hedgey-finances-response" class="hash-link" aria-label="Direct link to Hedgey Finance’s Response" title="Direct link to Hedgey Finance’s Response">​</a></h2>
<ol>
<li>
<p>Immediate Communication: - <a href="https://x.com/goforlindsey/status/1781605844192235738" target="_blank" rel="noopener noreferrer">Lindsey Winder of Hedgey Finance swiftly addressed the community on social media, pledging action and transparency.</a></p>
</li>
<li>
<p>Investigation and Collaboration: - Partnered with cybersecurity firms, law enforcement, and impacted entities to track and recover funds. <a href="https://x.com/hedgeyfinance/status/1785026046095466750" target="_blank" rel="noopener noreferrer">Hedgey Finance kept users informed through regular updates.</a></p>
</li>
<li>
<p>Security Enhancements: - Conducted multiple audits and implemented security improvements to prevent similar incidents. - Introduced white hat bounties to encourage vulnerability identification. - Developed Hedgey 2.0 with more robust security.</p>
</li>
<li>
<p>Community Support: - Supported impacted users by collaborating on token claim pages and providing regular updates, particularly to the NobleBlocks community.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="impact-on-redeem-and-plan-creation-rates">Impact on Redeem and Plan Creation Rates<a href="#impact-on-redeem-and-plan-creation-rates" class="hash-link" aria-label="Direct link to Impact on Redeem and Plan Creation Rates" title="Direct link to Impact on Redeem and Plan Creation Rates">​</a></h2>
<p>Redeem Activity Analysis</p>
<ul>
<li>Pre-Hack (April 1 - April 18): <a href="https://ide.bitquery.io/hedgey-redeemPlans-post-hack" target="_blank" rel="noopener noreferrer">Average of 19.43 redeem plans per day.</a></li>
<li>Post-Hack (April 19 onward): Average dropped to 7.62 redeems per day.</li>
<li>Observation: The decline suggests a decrease in user confidence initially, though total post-hack redeems show a rebound over time.</li>
</ul>
<p>Plan Creation Analysis</p>
<ul>
<li>Pre-Hack (April 1 - April 18): Average of 31.41 plans created per day.</li>
<li>Post-Hack: Decreased slightly to 27.16 plans per day.</li>
<li>Observation: While a drop is observed, total post-hack plan creation saw a recovery, indicating regained user confidence.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code-fix-and-updated-cancelcampaign-function">Code Fix and Updated cancelCampaign() Function<a href="#code-fix-and-updated-cancelcampaign-function" class="hash-link" aria-label="Direct link to Code Fix and Updated cancelCampaign() Function" title="Direct link to Code Fix and Updated cancelCampaign() Function">​</a></h2>
<p>Hedgey Finance updated the cancelCampaign() function to prevent unauthorized token transfers after campaign cancellation. The updated code snippet now deletes campaign approvals and lockups before initiating the token transfer, ensuring any unclaimed tokens are returned to the campaign manager without leaving approvals vulnerable.</p>
<p><img decoding="async" loading="lazy" src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXd6gjZdneSkpJA_k10cj2dNWw72PfDAO7THY37pieXCFWIVTr6zI39Gl-QxzuV4f_GYMgfrxPyLUK6JeD89TO89jfgO0UGgUDG6f7lBYutWbbls_vvnaWKFgECi9f2zQlYUGAXk?key=4txW0y9TvdjUk0Q0JjSepfYs" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="long-term-effects-and-community-sentiment">Long-Term Effects and Community Sentiment<a href="#long-term-effects-and-community-sentiment" class="hash-link" aria-label="Direct link to Long-Term Effects and Community Sentiment" title="Direct link to Long-Term Effects and Community Sentiment">​</a></h2>
<ol>
<li>
<p>Reputation Impact: - Hedgey Finance’s reputation suffered initially, but transparency in communication and a proactive response helped mitigate damage.</p>
</li>
<li>
<p>User Trust and Activity: - User trust took a hit, as evidenced by reduced platform engagement in the immediate aftermath. However, Hedgey’s efforts to support affected users and enhance platform security gradually restored confidence.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lessons-learned-and-preventive-measures">Lessons Learned and Preventive Measures<a href="#lessons-learned-and-preventive-measures" class="hash-link" aria-label="Direct link to Lessons Learned and Preventive Measures" title="Direct link to Lessons Learned and Preventive Measures">​</a></h2>
<p>Key Recommendations for DeFi Developers</p>
<ul>
<li>Revoke Approvals: Always revoke token approvals in contracts once they are no longer needed.</li>
<li>Use Secure ERC20 Implementations: Secure implementations from trusted sources like OpenZeppelin are essential.</li>
<li>Multi-Sig Wallets: Implement multi-signature wallets for sensitive transactions to prevent unauthorized access.</li>
<li>Audits and Testing: <a href="https://www.quillaudits.com/blog/smart-contract/smart-contract-audit" target="_blank" rel="noopener noreferrer">Comprehensive audits</a> and rigorous testing can identify and mitigate vulnerabilities before deployment.</li>
</ul>
<p>User Education</p>
<ul>
<li>Users should regularly review and revoke token permissions, avoid unaudited projects, and consider hardware wallets for additional security.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>The Hedgey Finance exploit underscored the necessity of thorough security protocols in DeFi platforms. Hedgey’s swift response, including increased security measures, transparent communication, and community engagement, has fostered a sense of renewed confidence. This incident serves as a critical reminder for all stakeholders in the DeFi ecosystem about the importance of continuous auditing, user education, and proactive vulnerability management.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/divyn/divyn.github.io/edit/main/docs/Personal_Blog/Web3/hedgey-exploit-6-months.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Personal_Blog/Web3/the-end-of-eoas-how-rip-7212-changes-ethereum"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">The End of EOAs? How RIP-7212 Changes Everything</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Personal_Blog/Web3/blockchain-data-observability-opentelemetry"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Blockchain Data Observability: When Your Data Pipeline Goes Offline</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#key-vulnerability-and-attack-flow" class="table-of-contents__link toc-highlight">Key Vulnerability and Attack Flow</a></li><li><a href="#impact-breakdown" class="table-of-contents__link toc-highlight">Impact Breakdown</a></li><li><a href="#timeline-of-key-events" class="table-of-contents__link toc-highlight">Timeline of Key Events</a></li><li><a href="#hedgey-finances-response" class="table-of-contents__link toc-highlight">Hedgey Finance’s Response</a></li><li><a href="#impact-on-redeem-and-plan-creation-rates" class="table-of-contents__link toc-highlight">Impact on Redeem and Plan Creation Rates</a></li><li><a href="#code-fix-and-updated-cancelcampaign-function" class="table-of-contents__link toc-highlight">Code Fix and Updated cancelCampaign() Function</a></li><li><a href="#long-term-effects-and-community-sentiment" class="table-of-contents__link toc-highlight">Long-Term Effects and Community Sentiment</a></li><li><a href="#lessons-learned-and-preventive-measures" class="table-of-contents__link toc-highlight">Lessons Learned and Preventive Measures</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Follow Me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/divyn" target="_blank" rel="noopener noreferrer" class="footer__link-item">Second GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/divyasshree_" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/divyasshree-n/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Divyasshree. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>